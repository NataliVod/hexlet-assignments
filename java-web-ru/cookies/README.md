# Cookies

## Ссылки

Один из вариантов использования куки - хранение товаров, добавленных покупателем в свою корзину. В этом упражнении мы упрощенно реализуем такой механизм

* [Методы для работы с контекстом](https://javalin.io/documentation#context)

## src/main/java/exercise/controller/PostController.java

## Задание

Реализуйте два обработчика

* POST */cart-items* для добавления товаров в корзину
* POST */cart-items/clean* для очистки корзины

Корзина должна храниться на клиенте в куках. Кроме самого товара, необходимо хранить количество единиц. Добавление товара приводит к увеличению счетчика и редиректу на главную. Подробнее смотрите в шаблоне *index.jte*. Для сериализации данных используйте библиотеку `Jackson`

## src/main/java/exercise/App.java

## Задание

Добавьте в приложение роутинг для этих маршрутов

### Подсказки

* Перед началом работы загляните в шаблон *index.jte* и изучите код обработчика главной страницы
* Так как куки работают только с текстовыми данными, а нам нудно передать составные данны, то их нужно будет преобразовать их в JSON и обратно. А в JSON используются двойные кавычки. Сервер Jetty, c котором работает фреймворк Javalin, не позволяет устанавливать двойные кавычки в куки. Поэтому перед установкой куки JSON строку нужно будет закодировать, а получении куки - раскодировать обратно:

```java
var json = "{\"key\": \"value\"}";

// Кодируем JSON в строку
// В таком виде его уже можно установить в куки
var encodedJson = UrlEncoded.encodeString(json);

// Обратный процесс
// Получаем значение из куки
String cookieValue = ctx.cookie("json");

// Декодируем обратно в JSON
// Дальше его уже можно десериализовать в Map
String decodedJson = UrlEncoded.decodeString(cookieValue);
```
